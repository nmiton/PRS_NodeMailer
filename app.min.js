require("dotenv").config();const{resolveSoa:resolveSoa}=require("dns"),express=require("express"),nodeMail=require("nodemailer"),path=require("path"),router=require("./router"),port=3e3,app=express();async function mainMail(user_name,user_email,user_telephone,user_message){const transporter=nodeMail.createTransport({service:"gmail",auth:{user:process.env.REACT_APP_ACCOUNT_GMAIL,pass:process.env.REACT_APP_SECRET_CODE_GMAIL}}),mailOption={from:"from",to:process.env.REACT_APP_ACCOUNT_GMAIL,subject:"Vous avez un nouveau message reçu depuis le formulaire de contact HôtenB.",html:`\n        <p>Message de la part de : ${user_name}</p>\n        <p>Coordonnées :</p>\n        <p>Téléphone : ${user_telephone}</p>\n        <p>Email : ${user_email}</p>\n        <p>Message :</p>\n        <p>${user_message}</p>\n        `};try{return await transporter.sendMail(mailOption),Promise.resolve("Email envoyé!")}catch(error){return Promise.reject(error)}}app.use(express.urlencoded({extended:!0})),app.use(express.static(path.join(__dirname,"/public"))),app.use("/",router),app.post("/contact",async(req,res,next)=>{const{yourname:yourname,youremail:youremail,yoursubject:yoursubject,yourmessage:yourmessage}=req.body;try{await mainMail(yourname,youremail,yoursubject,yourmessage),res.send("Email correctement envoyé!")}catch(error){res.send("L'email n'a pas pu être envoyé, veuillez réessayer ultérieurement.")}}),app.listen(3e3,(function(err){err?console.log("Erreur lors du démarrage du serveur!"):console.log("Le serveur a bien démarré sur le port n°3000")}));